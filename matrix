#!/bin/bash

# Name: Molly Johnson
# ONID: johnsmol
# CS 344 Fall 2018
# Due: 10/8/18
# Assignment 1
# All information used to implement this script is adapted
# from the OSU CS 344 Fall 2018 lectures and assignment hints
# unless otherwise specifically indicated.

dims(){
# NAME
# dims - figure out dimensions of a given matrix
# SYNOPSOS
# calculate and print num of rows, a space, and then the num of columns of the matrix
# DESCRIPTION
# This is the dims function. This function will take a valid file as an argument or
# accept input from stdin. If the file is not readable or too many/few arguments
# are given, it will print an error message to stderr and return a value of 1. If
# the file or stdin input is valid, it will print the number of rows, a space, and
# then the number of columns to stdout and returns 0.

# use the tempInputDims variable to hold path to file with passed in matrix (doesn't
# matter if passed in from stdin or froma file). $$ added to end of temp file in order
# to prevent any duplicate names being used again mistakenly
tempInputDims="tempdims$$"
if [ "$#" = "1" ]
then
	cat > "$tempInputDims"
elif [ "$#" = "2" ]
then
	tempInputDims=$2
fi

# loop through each row and increment counter variable to get num of rows
rowCount=0
while read myLine
do
	rowCount=$(expr $rowCount + 1)
done < $tempInputDims
# -n added to prevent echo from printing newline
# adapted from: https://www.linuxquestions.org/questions/linux-newbie-8/bash-echo-followed-by-command-on-the-same-line-4175447966/
echo -n "$rowCount "

# head normally reads in first 10 lines of text from a file ($2). -1 added to make head
# only read in the first row. All tabs are then transformed into newlines, and the number
# of newlines counted (wc is word count, and the -l option makes it only give the line count). Hence
# the number of new lines counted + the original first line will equal the number of columns from the original file.
# adapted from: https://stackoverflow.com/questions/5761212/count-number-of-columns-in-bash/5761234
head -1 $tempInputDims | tr '\t' '\n' | wc -l
}

# 
if [ "$#" = "1" ] || [ "$#" = "2" ]  
then
	if [ "$1" = "dims" ] || [ "$1" = "transpose" ] || [ "$1" = "mean" ]     
	then
		$1 "${@:1}"
	else
		echo "error: invalid number of arguments" 1>&2
		exit 1
	fi
elif [ "$#" = "3" ]
then
	if [ "$1" = "add" ] || [ "$1" = "multiply" ]  
	then
		$1 "${@:2}"
	else
		echo "error: invalid number of arguments" 1>&2
		exit 1
	fi
else
	echo "error: invalid number of arguments" 1>&2
	exit 1
fi
